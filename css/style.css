/* === TOKENS === */
:root {
  --bg: #FBFAF7;
  --bg-secondary: #F4F2EC;
  --surface: rgba(255,255,255,0.66);
  --surface-2: rgba(255,255,255,0.38);
  --bg-card: rgba(255,255,255,0.62);
  --bg-card-hover: rgba(255,255,255,0.82);
  --bg-header: rgba(251,250,247,0.82);
  --bg-player: rgba(251,250,247,0.92);
  --bg-expanded: radial-gradient(1200px 800px at 50% -10%, rgba(154,123,60,0.10), transparent 60%),
    linear-gradient(180deg, rgba(251,250,247,1) 0%, rgba(244,242,236,1) 100%);
  --border: rgba(0,0,0,0.06);
  --border-2: rgba(0,0,0,0.10);
  --border-active: rgba(154,123,60,0.38);
  --accent: #8D6B2D;
  --accent-dim: rgba(141,107,45,0.55);
  --accent-glow: rgba(141,107,45,0.10);
  --text: #141414;
  --text-secondary: rgba(20,20,20,0.56);
  --text-muted: rgba(20,20,20,0.34);
  --text-inverse: #FFFFFF;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
  --shadow-md: 0 10px 24px rgba(0,0,0,0.08);
  --shadow-lg: 0 18px 50px rgba(0,0,0,0.12);
  --radius: 14px;
  --radius-sm: 10px;
  --radius-lg: 18px;
  --player-h: 72px;
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --font-zh: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-en: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
}

[data-theme="dark"] {
  --bg: #0C0D0F;
  --bg-secondary: #121418;
  --surface: rgba(255,255,255,0.06);
  --surface-2: rgba(255,255,255,0.04);
  --bg-card: rgba(255,255,255,0.06);
  --bg-card-hover: rgba(255,255,255,0.10);
  --bg-header: rgba(12,13,15,0.76);
  --bg-player: rgba(12,13,15,0.90);
  --bg-expanded: radial-gradient(1200px 800px at 50% -10%, rgba(212,165,74,0.12), transparent 60%),
    linear-gradient(180deg, rgba(12,13,15,1) 0%, rgba(18,20,24,1) 100%);
  --border: rgba(255,255,255,0.10);
  --border-2: rgba(255,255,255,0.16);
  --border-active: rgba(212,165,74,0.34);
  --accent: #D8B15A;
  --accent-dim: rgba(216,177,90,0.55);
  --accent-glow: rgba(216,177,90,0.14);
  --text: #F1F2F4;
  --text-secondary: rgba(241,242,244,0.60);
  --text-muted: rgba(241,242,244,0.34);
  --text-inverse: #0C0D0F;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.30);
  --shadow-md: 0 10px 24px rgba(0,0,0,0.42);
  --shadow-lg: 0 18px 50px rgba(0,0,0,0.58);
}

/* === RESET === */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{font-size:16px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;scroll-behavior:smooth;overflow-x:hidden}
body{-webkit-tap-highlight-color:transparent;font-family:var(--font-zh);background:var(--bg);background-image:
  radial-gradient(900px 520px at 50% -10%, rgba(141,107,45,0.08), transparent 60%),
  linear-gradient(180deg, rgba(141,107,45,0.03) 0%, transparent 38%);
color:var(--text);min-height:100vh;min-height:100dvh;overflow-x:hidden;max-width:100vw;transition:background .35s,color .35s}
[data-theme="dark"] body{background-image:
  radial-gradient(900px 520px at 50% -10%, rgba(216,177,90,0.10), transparent 60%),
  linear-gradient(180deg, rgba(216,177,90,0.03) 0%, transparent 38%)}

@media(prefers-reduced-motion:reduce){
  *,*::before,*::after{animation-duration:0.01ms!important;transition-duration:0.01ms!important}
}

/* === APP SHELL === */
#app{min-height:100vh;min-height:100dvh;display:flex;flex-direction:column;max-width:100vw;overflow-x:hidden}

/* === HEADER - top bar === */
.header{position:sticky;top:0;z-index:100;background:var(--bg-header);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:1px solid var(--border);transition:background .35s}
.nav{display:flex;align-items:center;padding:0 14px;height:54px;gap:0}
.logo{display:flex;align-items:center;gap:6px;flex-shrink:0;color:var(--text)}
.logo svg{width:34px;height:22px}
.logo-title{font-size:.84rem;font-weight:500;color:var(--text-secondary);white-space:nowrap;letter-spacing:.02em}
.nav-spacer{flex:1}
.nav-center{position:absolute;left:50%;transform:translateX(-50%);font-size:.98rem;font-weight:650;color:var(--text);white-space:nowrap;pointer-events:none;letter-spacing:.02em}

/* === BOTTOM TAB BAR === */
.tab-bar{position:fixed;bottom:0;left:0;right:0;z-index:190;background:var(--bg-header);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);border-top:1px solid var(--border);padding-bottom:var(--safe-bottom);display:flex;justify-content:space-around;align-items:flex-end;height:calc(66px + var(--safe-bottom));transition:transform .3s}
.tab-bar.hide{transform:translateY(100%)}
.tab{background:none;border:none;padding:10px 0 8px;font-family:var(--font-zh);font-size:.68rem;font-weight:450;color:var(--text-muted);cursor:pointer;position:relative;transition:color .2s;white-space:nowrap;flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;min-width:0}
.tab-icon{width:24px;height:24px;stroke:currentColor;fill:none;stroke-width:1.6;stroke-linecap:round;stroke-linejoin:round}
.tab.active{color:var(--accent);font-weight:650}
.tab.active .tab-icon{stroke-width:2}
.tab-sub{display:none}

/* === CENTER PLAY BUTTON in tab bar === */
.tab-center{flex:1;display:flex;align-items:center;justify-content:center;padding:0 0 6px;position:relative}
.center-play-btn{position:relative;width:50px;height:50px;margin-top:-20px;border:none;background:linear-gradient(180deg, rgba(255,255,255,0.22), transparent 40%), var(--accent);border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 24px rgba(141,107,45,0.30);transition:transform .15s,box-shadow .15s,filter .15s;z-index:2;-webkit-appearance:none;appearance:none}
.center-play-btn:active{transform:scale(0.94)}
.center-play-btn svg.center-play-icon{width:22px;height:22px;fill:var(--text-inverse);stroke:none;position:relative;z-index:2}
.center-play-btn .progress-ring{position:absolute;inset:-4px;width:56px;height:56px;z-index:1;transform:rotate(-90deg)}
.center-play-btn .progress-ring-bg{fill:none;stroke:var(--border);stroke-width:3}
.center-play-btn .progress-ring-fill{fill:none;stroke:var(--accent);stroke-width:3;stroke-linecap:round;stroke-dasharray:157;stroke-dashoffset:157;transition:stroke-dashoffset .15s linear}
.center-play-btn.playing{animation:centerSpin 8s linear infinite}
@keyframes centerSpin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.center-play-btn.playing .progress-ring{animation:centerSpinReverse 8s linear infinite}
@keyframes centerSpinReverse{from{transform:rotate(-90deg)}to{transform:rotate(calc(-90deg - 360deg))}}

/* Icon buttons */
.nav-actions{display:flex;align-items:center;gap:0;flex-shrink:0}
.btn-icon{-webkit-appearance:none;appearance:none;background:none;border:none;border-radius:50%;width:36px;height:36px;min-width:36px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-muted);transition:all .2s;padding:0}
.btn-icon:hover,.btn-icon:active{color:var(--text)}
.btn-icon.active{color:var(--accent)}
.btn-icon svg{width:17px;height:17px;stroke:currentColor;fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}


/* Search */
.search-row{padding:8px 14px 6px;display:none}
.search-row.show{display:block}
.search-field{width:100%;padding:11px 14px 11px 38px;border:1px solid var(--border);border-radius:calc(var(--radius-sm) + 2px);background:var(--bg-card);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);box-shadow:var(--shadow-sm);font-family:var(--font-zh);font-size:.9rem;color:var(--text);outline:none;transition:border-color .2s,box-shadow .2s,background .2s}
.search-field:focus{border-color:var(--border-active)}
.search-field::placeholder{color:var(--text-muted)}
.search-box{position:relative}
.search-box svg{position:absolute;left:11px;top:50%;transform:translateY(-50%);width:15px;height:15px;stroke:var(--text-muted);fill:none;stroke-width:1.8;pointer-events:none}

/* === CONTENT === */
.content{flex:1;padding:16px 16px calc(66px + var(--safe-bottom) + 16px);overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}
.content.has-player{padding-bottom:calc(64px + var(--safe-bottom) + 14px)}

.view{display:none;animation:viewIn .3s ease-out}
.view.active{display:block}
@keyframes viewIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

/* === SERIES CARDS - simplified minimal === */
.series-list{display:flex;flex-direction:column;gap:10px}
.card{display:flex;align-items:center;gap:12px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:15px 15px;cursor:pointer;transition:transform .12s,background .2s,border-color .2s,box-shadow .2s;min-height:52px;box-shadow:var(--shadow-sm);backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px)}
.card:hover,.card:active{background:var(--bg-card-hover);border-color:var(--border-active);box-shadow:var(--shadow-md)}
.card:active{transform:translateY(1px)}
.card-icon{width:36px;height:36px;border-radius:8px;background:var(--bg-secondary);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.card-icon svg{width:18px;height:18px;stroke:var(--text-muted);fill:none;stroke-width:1.8}
.card-body{flex:1;min-width:0}
.card-title{font-size:.94rem;font-weight:650;color:var(--text);line-height:1.3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.card-meta{font-size:.72rem;color:var(--text-secondary);margin-top:2px}
.card-intro{font-size:.72rem;color:var(--text-secondary);margin-top:3px;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.card-arrow{color:var(--text-muted);flex-shrink:0}
.card-arrow svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2}
.card.now-playing{border-color:var(--border-active);background:var(--accent-glow)}
.card.now-playing .card-icon{background:var(--accent);opacity:.85}
.card.now-playing .card-icon svg{stroke:var(--text-inverse)}
.card-playing-tag{font-size:.6rem;color:var(--accent);margin-left:6px;font-weight:500;white-space:nowrap}

@media(min-width:500px){
  .series-list{display:grid;grid-template-columns:1fr 1fr;gap:10px}
}
@media(min-width:768px){
  .series-list{grid-template-columns:1fr 1fr 1fr}
  .content{max-width:900px;margin:0 auto;padding-left:24px;padding-right:24px}
  .nav{max-width:900px;margin-left:auto;margin-right:auto}
  .tab-bar{max-width:420px;left:50%;transform:translateX(-50%);border-radius:16px 16px 0 0;border-left:1px solid var(--border);border-right:1px solid var(--border)}
}

/* === EPISODE LIST === */
.ep-header{display:flex;align-items:center;gap:10px;margin-bottom:14px;padding-bottom:12px;border-bottom:1px solid var(--border)}
.btn-back{-webkit-appearance:none;appearance:none;background:var(--surface);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;min-width:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-secondary);transition:transform .12s,background .2s,border-color .2s,color .2s,box-shadow .2s;box-shadow:var(--shadow-sm);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px)}
.btn-back:hover{background:var(--bg-card-hover);border-color:var(--border-active);color:var(--text);box-shadow:var(--shadow-md)}
.btn-back:active{transform:scale(0.96)}
.btn-back svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:2}
.ep-header-info{flex:1;min-width:0}
.ep-header-title{font-size:1rem;font-weight:500;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ep-header-sub{font-size:.72rem;color:var(--text-secondary);margin-top:1px}
.ep-header-intro{font-size:.72rem;color:var(--text-secondary);margin-top:4px;line-height:1.4;opacity:.8}
.btn-play-all{-webkit-appearance:none;appearance:none;background:linear-gradient(180deg, rgba(255,255,255,0.22), transparent 40%), var(--accent);border:none;border-radius:50%;width:44px;height:44px;min-width:44px;cursor:pointer;transition:transform .15s,filter .15s,box-shadow .2s;flex-shrink:0;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 22px rgba(141,107,45,0.26)}
.btn-play-all:hover{filter:brightness(1.02);transform:scale(1.04)}
.btn-play-all:active{transform:scale(0.95)}
.btn-play-all svg{width:16px;height:16px;fill:var(--text-inverse);stroke:none}

.ep-list{list-style:none}
.ep-item{display:flex;align-items:center;gap:10px;padding:12px;border-radius:var(--radius-sm);cursor:pointer;transition:background .15s;min-height:44px}
.ep-item:hover{background:var(--accent-glow)}
.ep-item.playing{background:var(--accent-glow)}
.ep-num{font-family:var(--font-en);font-size:.78rem;color:var(--text-muted);width:28px;text-align:center;flex-shrink:0}
.ep-item.playing .ep-num{display:none}
.eq-bars{display:none;width:28px;justify-content:center;align-items:flex-end;gap:2px;height:14px;flex-shrink:0}
.ep-item.playing .eq-bars{display:flex}
.eq-bar{width:2px;background:var(--accent);border-radius:1px;animation:eqBars .7s ease-in-out infinite}
.eq-bar:nth-child(1){height:50%;animation-delay:0s}
.eq-bar:nth-child(2){height:100%;animation-delay:.12s}
.eq-bar:nth-child(3){height:40%;animation-delay:.24s}
.eq-bar:nth-child(4){height:70%;animation-delay:.36s}
@keyframes eqBars{0%,100%{transform:scaleY(.35)}50%{transform:scaleY(1)}}
.ep-text{flex:1;min-width:0;overflow:hidden}
.ep-title{font-size:.86rem;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ep-intro{display:block;font-size:.7rem;color:var(--text-secondary);margin-top:1px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ep-item.playing .ep-title{color:var(--accent);font-weight:500}

/* === PLAYLIST PANEL (slides up in expanded player) === */
.playlist-panel{display:none;flex-direction:column;flex:1;overflow:hidden;padding:0 20px}
.playlist-panel.show{display:flex}
.playlist-head{display:flex;align-items:center;justify-content:space-between;padding:0 0 10px;border-bottom:1px solid var(--border);margin-bottom:6px;flex-shrink:0}
.playlist-head-title{font-size:.86rem;font-weight:500;color:var(--text)}
.playlist-count{font-family:var(--font-en);font-size:.7rem;color:var(--text-muted)}
.playlist-items{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}
.pl-item{display:flex;align-items:center;gap:10px;padding:10px 4px;cursor:pointer;border-radius:var(--radius-sm);transition:background .15s;min-height:44px}
.pl-item:hover{background:var(--accent-glow)}
.pl-item.current{background:var(--accent-glow)}
.pl-item-num{font-family:var(--font-en);font-size:.72rem;color:var(--text-muted);width:24px;text-align:center;flex-shrink:0}
.pl-item.current .pl-item-num{color:var(--accent)}
.pl-item-title{flex:1;font-size:.82rem;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:0}
.pl-item.current .pl-item-title{color:var(--accent);font-weight:500}

/* === PLAYER BAR - hidden (replaced by center play button) === */
.player{display:none}

/* Control buttons - modern circle style */
.ctrl{-webkit-appearance:none;appearance:none;background:none;border:none;color:var(--text-secondary);cursor:pointer;width:46px;height:46px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:transform .12s,background .15s,color .15s,box-shadow .15s}
.ctrl:hover{color:var(--text);background:var(--surface);box-shadow:var(--shadow-sm)}
.ctrl:active{transform:scale(0.96)}
.ctrl svg{width:20px;height:20px;stroke:currentColor;fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}
.ctrl.active{color:var(--accent)}

/* Play/pause - the hero button */
.ctrl-play{width:46px;height:46px;background:linear-gradient(180deg, rgba(255,255,255,0.22), transparent 40%), var(--accent);border-radius:50%;color:var(--text-inverse);box-shadow:0 12px 26px rgba(141,107,45,0.28)}
.ctrl-play:hover{filter:brightness(1.02);transform:scale(1.04);color:var(--text-inverse)}
.ctrl-play svg{width:20px;height:20px;fill:currentColor;stroke:none}

/* === EXPANDED PLAYER === */
.expanded{position:fixed;inset:0;z-index:300;background:var(--bg-expanded);transform:translateY(100%);transition:transform .42s cubic-bezier(.16,1,.3,1);display:flex;flex-direction:column;overflow:hidden}
.expanded.show{transform:translateY(0)}

/* Top bar - fixed at top */
.exp-top{display:flex;align-items:center;justify-content:space-between;padding:max(12px,env(safe-area-inset-top)) 16px 8px;flex-shrink:0}
.exp-label{font-family:var(--font-en);font-size:.68rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.12em;font-weight:500}
.exp-top .btn-icon{min-width:44px;height:44px}
.exp-top-right{display:flex;align-items:center;gap:0}

/* Scrollable middle area */
.exp-player-content{display:flex;flex-direction:column;flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;padding:0 20px;position:relative}
.exp-player-content.hide{display:none}

/* Series info area (replaces cover art) */
.exp-series-info{width:min(280px,76vw);margin:10px auto 22px;background:var(--bg-card);border:1px solid var(--border);border-radius:22px;padding:22px 18px;text-align:center;position:relative;overflow:hidden;flex-shrink:0;box-shadow:var(--shadow-md);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px)}
.exp-series-info::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 35% 35%,var(--accent-glow),transparent 60%)}
.exp-series-icon{width:52px;height:34px;margin:0 auto 12px;stroke:var(--accent);fill:none;stroke-width:1;opacity:.4}
.exp-series-name{font-size:.88rem;font-weight:500;color:var(--text);margin-bottom:3px;position:relative;line-height:1.4}
.exp-series-speaker{font-size:.72rem;color:var(--text-secondary);position:relative}
.exp-series-ep-count{font-family:var(--font-en);font-size:.66rem;color:var(--text-muted);margin-top:5px;position:relative}

/* Track info */
.exp-info{text-align:center;margin-bottom:20px;flex-shrink:0}
.exp-title{font-size:1.05rem;font-weight:500;color:var(--text);margin-bottom:3px;line-height:1.4}
.exp-series{font-size:.75rem;color:var(--text-secondary)}

/* Bottom controls area - pinned to bottom */
.exp-bottom{flex-shrink:0;padding:0 20px max(16px,var(--safe-bottom));background:linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.02) 100%)}
[data-theme="dark"] .exp-bottom{background:linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.22) 100%)}

/* Progress bar */
.exp-progress{margin-bottom:14px;touch-action:none;-webkit-user-select:none;user-select:none}
.exp-progress-bar{width:100%;height:36px;cursor:pointer;position:relative;display:flex;align-items:center}
.exp-progress-track{width:100%;height:5px;background:var(--border);border-radius:999px;position:relative}
.exp-progress-fill{height:100%;background:var(--accent);border-radius:2px;width:0%;transition:width .1s linear;position:relative;z-index:1}
.exp-progress-thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:16px;height:16px;background:var(--accent);border-radius:50%;box-shadow:0 10px 22px rgba(141,107,45,0.28);left:0%;transition:left .1s linear;z-index:2}
.exp-time{display:flex;justify-content:space-between;font-family:var(--font-en);font-size:.7rem;color:var(--text-muted);margin-top:2px}

/* Expanded controls - 5 buttons: skip-15 / prev / play / next / skip+15 */
.exp-ctrls{display:flex;align-items:center;justify-content:center;gap:6px;margin-bottom:12px}
.exp-ctrls .ctrl{width:46px;height:46px}
.exp-ctrls .ctrl svg{width:20px;height:20px}
.exp-ctrls .ctrl-play{width:58px;height:58px;box-shadow:0 4px 20px rgba(154,123,60,0.3)}
.exp-ctrls .ctrl-play svg{width:24px;height:24px}
.exp-ctrls .ctrl-skip{position:relative}
.exp-ctrls .ctrl-skip svg{width:20px;height:20px}
.exp-ctrls .ctrl-skip .skip-label{position:absolute;font-family:var(--font-en);font-size:.5rem;font-weight:700;color:currentColor;bottom:8px;left:50%;transform:translateX(-50%);pointer-events:none;line-height:1}

/* Secondary: loop / speed / timer / playlist */
.exp-secondary{display:flex;align-items:center;justify-content:center;gap:12px}
.exp-secondary .ctrl{width:42px;height:42px}

/* Sleep timer badge */
.timer-badge{position:absolute;top:2px;right:2px;background:var(--accent);color:var(--text-inverse);font-family:var(--font-en);font-size:.5rem;font-weight:600;min-width:16px;height:16px;border-radius:8px;display:flex;align-items:center;justify-content:center;padding:0 3px;line-height:1}

/* === SEARCH RESULTS === */
.search-label{font-size:.78rem;color:var(--text-secondary);margin-bottom:10px;padding-left:4px}

/* === LOADING === */
.loader{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:12px}
.loader svg{width:36px;height:36px;stroke:var(--accent);fill:none;stroke-width:1.2;opacity:.4;animation:breathe 2.5s ease-in-out infinite}
@keyframes breathe{0%,100%{transform:scale(1);opacity:.4}50%{transform:scale(1.05);opacity:.6}}
.loader-text{font-family:var(--font-en);font-size:.78rem;color:var(--text-muted)}

/* Error state */
.error-msg{text-align:center;padding:40px 20px;color:var(--text-secondary);font-size:.88rem}
.error-msg button{margin-top:12px;background:var(--accent);color:var(--text-inverse);border:none;border-radius:20px;padding:8px 20px;font-family:var(--font-zh);font-size:.82rem;cursor:pointer}

/* === SCROLLBAR === */
::-webkit-scrollbar{width:3px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}

/* === LANDSCAPE === */
@media(orientation:landscape) and (max-height:500px){
  .exp-series-info{width:min(160px,28vw);margin-bottom:8px;padding:14px 12px}
  .exp-series-icon{width:40px;height:26px;margin-bottom:8px}
  .exp-player-content{flex-direction:row;flex-wrap:wrap;align-items:flex-start;gap:12px}
  .exp-player-content .exp-series-info{margin:0}
  .exp-bottom{padding-top:4px}
}

.sr-only{position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap}

/* === ABOUT MODAL === */
.about-overlay{display:none;position:fixed;inset:0;z-index:500;background:rgba(0,0,0,0.45);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);align-items:center;justify-content:center;padding:20px}
.about-overlay.show{display:flex;animation:aboutFadeIn .25s ease-out}
@keyframes aboutFadeIn{from{opacity:0}to{opacity:1}}
.about-modal{background:var(--bg);border:1px solid var(--border);border-radius:16px;box-shadow:0 8px 40px rgba(0,0,0,0.15);max-width:420px;width:100%;max-height:80vh;overflow-y:auto;padding:28px 24px;position:relative;animation:aboutSlideUp .3s cubic-bezier(.16,1,.3,1)}
@keyframes aboutSlideUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.about-close{position:absolute;top:12px;right:12px;background:none;border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-muted);transition:all .2s}
.about-close:hover{color:var(--text);background:var(--accent-glow)}
.about-close svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round}
.about-logo{display:flex;justify-content:center;margin-bottom:16px}
.about-logo svg{width:48px;height:48px}
.about-title{text-align:center;font-size:1.05rem;font-weight:600;color:var(--text);margin-bottom:4px}
.about-subtitle{text-align:center;font-family:var(--font-en);font-size:.72rem;color:var(--text-muted);letter-spacing:.08em;margin-bottom:20px}
.about-section{margin-bottom:16px}
.about-section-title{font-size:.78rem;font-weight:600;color:var(--accent);margin-bottom:6px;display:flex;align-items:center;gap:6px}
.about-section-title svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2}
.about-text{font-size:.8rem;color:var(--text-secondary);line-height:1.65}
.about-text a{color:var(--accent);text-decoration:none}
.about-text a:hover{text-decoration:underline}
.about-footer{text-align:center;font-size:.72rem;color:var(--text-muted);margin-top:20px;padding-top:16px;border-top:1px solid var(--border);line-height:1.5}

/* === PWA INSTALL BANNER === */
.install-banner{display:none;position:fixed;bottom:0;left:0;right:0;z-index:250;background:var(--bg);border-top:1px solid var(--border);box-shadow:0 -4px 20px rgba(0,0,0,0.08);padding:16px 16px calc(16px + var(--safe-bottom));animation:bannerSlide .4s cubic-bezier(.16,1,.3,1)}
.install-banner.show{display:block}
.install-banner.above-player{bottom:var(--player-h)}
@keyframes bannerSlide{from{transform:translateY(100%)}to{transform:translateY(0)}}
.install-inner{display:flex;align-items:center;gap:12px;max-width:500px;margin:0 auto}
.install-icon{width:40px;height:40px;border-radius:10px;background:var(--accent-glow);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.install-icon svg{width:22px;height:22px;stroke:var(--accent);fill:none;stroke-width:1.8}
.install-text{flex:1;min-width:0}
.install-title{font-size:.84rem;font-weight:500;color:var(--text)}
.install-desc{font-size:.72rem;color:var(--text-secondary);margin-top:1px}
.install-actions{display:flex;gap:8px;flex-shrink:0}
.install-btn{-webkit-appearance:none;appearance:none;border:none;border-radius:20px;padding:8px 16px;font-family:var(--font-zh);font-size:.78rem;font-weight:500;cursor:pointer;transition:all .2s}
.install-btn-primary{background:var(--text);color:var(--text-inverse)}
.install-btn-primary:hover{opacity:.88}
.install-btn-dismiss{background:var(--bg-card);color:var(--text-secondary);border:1px solid var(--border)}

/* === SPEED CONTROL === */
.speed-btn{font-family:var(--font-en);font-size:.7rem;font-weight:600;min-width:44px;letter-spacing:-.01em}
.speed-btn .ctrl-label{font-size:.66rem}

/* === MY PAGE === */
.my-page{display:none;animation:viewIn .3s ease-out}
.my-page.active{display:block}
.my-profile{display:flex;flex-direction:column;align-items:center;padding:28px 0 20px}
.my-avatar{width:72px;height:72px;border-radius:50%;border:2px solid var(--border);box-shadow:0 2px 12px rgba(154,123,60,0.12);background:var(--accent-glow);display:flex;align-items:center;justify-content:center}
.my-avatar svg{width:40px;height:26px}
.my-name{font-size:1rem;font-weight:500;color:var(--text);margin-top:10px}
.my-subtitle{font-size:.72rem;color:var(--text-secondary);margin-top:2px}
.my-section{margin-bottom:20px}
.my-section-title{font-size:.72rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.06em;padding:0 4px 8px;font-weight:500}
.my-list{display:flex;flex-direction:column;gap:1px;background:var(--border);border-radius:var(--radius);overflow:hidden}
.my-item{display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-card);cursor:pointer;transition:background .15s;min-height:44px}
.my-item:hover{background:var(--bg-card-hover)}
.my-item-icon{width:20px;height:20px;stroke:var(--text-secondary);fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round;flex-shrink:0}
.my-item-label{flex:1;font-size:.86rem;color:var(--text)}
.my-item-value{font-size:.78rem;color:var(--text-secondary)}
.my-item-arrow{width:14px;height:14px;stroke:var(--text-muted);fill:none;stroke-width:2;flex-shrink:0}
.my-namo{text-align:center;font-size:.82rem;color:var(--accent);font-weight:400;margin-top:24px;opacity:.6;letter-spacing:.08em}
/* history list */
.my-history-item{display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-card);cursor:pointer;transition:background .15s;min-height:44px}
.my-history-item:hover{background:var(--bg-card-hover)}
.my-history-icon{width:32px;height:32px;border-radius:8px;background:var(--accent-glow);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.my-history-icon svg{width:14px;height:14px;stroke:var(--accent);fill:none;stroke-width:2}
.my-history-body{flex:1;min-width:0}
.my-history-title{font-size:.84rem;color:var(--text);font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.my-history-sub{font-size:.72rem;color:var(--text-secondary);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.my-history-time{font-size:.68rem;color:var(--text-muted);flex-shrink:0;white-space:nowrap}
.my-history-empty{text-align:center;padding:20px 16px;color:var(--text-muted);font-size:.8rem}
/* install guide card */
.my-install-card{padding:16px;background:var(--bg-card);border-radius:var(--radius);overflow:hidden}
.my-install-top{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.my-install-icon{width:40px;height:40px;border-radius:10px;background:var(--accent-glow);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.my-install-icon svg{width:20px;height:20px;stroke:var(--accent);fill:none;stroke-width:1.8;stroke-linecap:round}
.my-install-text{flex:1}
.my-install-text-title{font-size:.86rem;font-weight:500;color:var(--text)}
.my-install-text-desc{font-size:.72rem;color:var(--text-secondary);margin-top:2px}
.my-install-benefit{font-size:.72rem;color:var(--text-muted);margin-bottom:12px;line-height:1.5;padding:8px 12px;background:var(--accent-glow);border-radius:8px}
.my-install-steps{font-size:.78rem;color:var(--text-secondary);line-height:1.6;margin-bottom:12px}
.my-install-steps .ios-icon{display:inline-block;width:18px;height:18px;vertical-align:middle;margin:0 2px}
.my-install-btn{display:block;width:100%;padding:10px;border:none;border-radius:8px;background:var(--accent);color:var(--text-inverse);font-size:.84rem;font-weight:500;cursor:pointer;text-align:center;transition:opacity .15s}
.my-install-btn:hover{opacity:.85}
/* history mini progress bar */
.my-history-progress{width:100%;height:2px;background:var(--border);border-radius:1px;margin-top:4px}
.my-history-progress-fill{height:100%;background:var(--accent);border-radius:1px;transition:width .2s}
/* history "view all" link */
.my-history-more{display:flex;align-items:center;justify-content:center;gap:4px;padding:12px 16px;background:var(--bg-card);cursor:pointer;font-size:.78rem;color:var(--accent);transition:background .15s}
.my-history-more:hover{background:var(--bg-card-hover)}
/* history overlay */
.history-overlay{display:none;position:fixed;inset:0;z-index:500;background:rgba(0,0,0,0.45);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);align-items:flex-end;justify-content:center;padding:0}
.history-overlay.show{display:flex;animation:aboutFadeIn .25s ease-out}
.history-modal{background:var(--bg);border-radius:16px 16px 0 0;width:100%;max-width:500px;max-height:85vh;display:flex;flex-direction:column;animation:histSlideUp .3s cubic-bezier(.16,1,.3,1)}
@keyframes histSlideUp{from{transform:translateY(40px);opacity:0}to{transform:translateY(0);opacity:1}}
.history-head{display:flex;align-items:center;justify-content:space-between;padding:18px 20px 12px;flex-shrink:0;border-bottom:1px solid var(--border)}
.history-head-title{font-size:.92rem;font-weight:500;color:var(--text)}
.history-clear-btn{-webkit-appearance:none;appearance:none;border:1px solid var(--border);background:var(--bg-card);color:var(--text-secondary);font-size:.72rem;padding:5px 12px;border-radius:14px;cursor:pointer;font-family:inherit;transition:all .15s}
.history-clear-btn:hover{color:var(--text);border-color:var(--text-muted)}
.history-list{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:max(16px,var(--safe-bottom))}
.history-del-btn{width:28px;height:28px;border:none;background:none;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;flex-shrink:0;color:var(--text-muted);transition:all .15s}
.history-del-btn:hover{color:var(--text);background:var(--accent-glow)}
.history-del-btn svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round}
.history-empty{text-align:center;padding:40px 16px;color:var(--text-muted);font-size:.82rem}
/* expanded player swipe dismiss */
.expanded.swiping{transition:none!important;will-change:transform}
.expanded.snap-back{transition:transform .3s cubic-bezier(.16,1,.3,1)!important}
/* double-tap indicator */
.exp-dbl-indicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.6rem;font-weight:600;color:var(--text);opacity:0;pointer-events:none;z-index:10;white-space:nowrap;text-shadow:0 2px 8px rgba(0,0,0,0.1)}
.exp-dbl-indicator.flash{animation:dblFlash .6s ease-out forwards}
@keyframes dblFlash{0%{opacity:0;transform:translate(-50%,-50%) scale(.8)}15%{opacity:1;transform:translate(-50%,-50%) scale(1)}100%{opacity:0;transform:translate(-50%,-50%) scale(1)}}
.exp-dbl-indicator.left{left:25%}
.exp-dbl-indicator.right{left:75%}
/* progress thumb drag enhancement */
.exp-progress-thumb.dragging{transform:translate(-50%,-50%) scale(1.6)!important;transition:none!important}
.exp-seek-tooltip{position:absolute;top:-28px;transform:translateX(-50%);background:var(--text);color:var(--text-inverse);font-family:var(--font-en);font-size:.68rem;padding:3px 7px;border-radius:4px;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .15s;z-index:5}
.exp-seek-tooltip.show{opacity:1}

/* === HOME PAGE === */
.home-page{display:none;animation:viewIn .3s ease-out}
.home-page.active{display:block}
.home-section{margin-bottom:22px}
.home-section-title{font-size:.9rem;color:var(--text-secondary);letter-spacing:.01em;padding:0 4px 10px;font-weight:700}
.home-quote{background:var(--bg-card);border-radius:var(--radius-lg);padding:22px 18px;position:relative;border:1px solid var(--border);box-shadow:var(--shadow-sm);backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px)}
.home-quote::before{content:'\201C';position:absolute;top:6px;left:12px;font-size:2.6rem;color:var(--accent);opacity:.22;font-family:Georgia,serif;line-height:1}
.home-quote-text{font-size:.94rem;line-height:1.75;color:var(--text);padding-left:8px;font-weight:450}
.home-quote-author{font-size:.72rem;color:var(--text-secondary);margin-top:8px;text-align:right;padding-right:4px}
.home-chanting-scroll{display:flex;gap:10px;overflow-x:auto;padding:0 0 8px;-webkit-overflow-scrolling:touch;scrollbar-width:none}
.home-chanting-scroll::-webkit-scrollbar{display:none}
.home-chant-card{flex-shrink:0;width:120px;background:var(--bg-card);border-radius:var(--radius-sm);padding:14px 12px;text-align:center;border:1px solid var(--border);cursor:pointer;transition:background .15s,border-color .15s}
.home-chant-card:hover{background:var(--bg-card-hover);border-color:var(--border-active)}
.home-chant-card.playing{border-color:var(--accent);background:var(--accent-glow)}
.home-chant-icon{width:32px;height:32px;margin:0 auto 8px;border-radius:50%;background:var(--accent-glow);display:flex;align-items:center;justify-content:center}
.home-chant-icon svg{width:16px;height:16px;fill:none;stroke:var(--accent);stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
.home-chant-card.playing .home-chant-icon{background:var(--accent)}
.home-chant-card.playing .home-chant-icon svg{stroke:var(--text-inverse)}
.home-chant-name{font-size:.74rem;color:var(--text);line-height:1.3;font-weight:400}
.home-continue-card{display:flex;align-items:center;gap:12px;background:var(--bg-card);border-radius:var(--radius);padding:14px 16px;border:1px solid var(--border);cursor:pointer;transition:background .15s;position:relative;overflow:hidden}
.home-continue-card:hover{background:var(--bg-card-hover)}
.home-continue-icon{width:40px;height:40px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.home-continue-icon svg{width:18px;height:18px;fill:none;stroke:var(--text-inverse);stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
.home-continue-body{flex:1;min-width:0}
.home-continue-title{font-size:.86rem;color:var(--text);font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.home-continue-sub{font-size:.72rem;color:var(--text-secondary);margin-top:2px}
.home-continue-progress{position:absolute;bottom:0;left:0;right:0;height:3px;background:var(--border);border-radius:0 0 var(--radius) var(--radius)}
.home-continue-progress-fill{height:100%;background:var(--accent);border-radius:0 0 var(--radius) var(--radius);transition:width .3s}
.home-continue-card.playing{border-color:var(--border-active);background:var(--accent-glow)}
.home-continue-card.playing .home-continue-icon{animation:eqPulse 1.5s ease-in-out infinite}
@keyframes eqPulse{0%,100%{opacity:1}50%{opacity:.6}}
.home-rec-list{display:flex;flex-direction:column;gap:8px}
.home-rec-card{display:flex;align-items:center;gap:12px;background:var(--bg-card);border-radius:var(--radius);padding:14px 16px;border:1px solid var(--border);cursor:pointer;transition:background .15s}
.home-rec-card:hover{background:var(--bg-card-hover)}
.home-rec-icon{width:40px;height:40px;border-radius:var(--radius-sm);background:var(--accent-glow);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.home-rec-icon svg{width:20px;height:20px;fill:none;stroke:var(--accent);stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}
.home-rec-body{flex:1;min-width:0}
.home-rec-title{font-size:.86rem;color:var(--text);font-weight:500}
.home-rec-sub{font-size:.72rem;color:var(--text-secondary);margin-top:2px}

/* === BUFFERING === */
.player-track.buffering::after{content:'...';animation:bufDots 1s steps(3) infinite}
@keyframes bufDots{0%{content:'.'}33%{content:'..'}66%{content:'...'}}
.center-play-btn.buffering{animation:centerPulse 1.2s ease-in-out infinite}
@keyframes centerPulse{0%,100%{box-shadow:0 2px 16px rgba(154,123,60,.3)}50%{box-shadow:0 2px 24px rgba(154,123,60,.6)}}
.exp-progress-buffer{position:absolute;height:100%;background:var(--accent);opacity:.15;border-radius:2px;width:0%;transition:width .3s linear}
/* === iOS PWA GUIDE === */
.ios-guide{display:none;position:fixed;bottom:0;left:0;right:0;z-index:250;background:var(--bg);border-top:1px solid var(--border);box-shadow:0 -4px 20px rgba(0,0,0,0.08);padding:16px;padding-bottom:calc(16px + var(--safe-bottom));animation:bannerSlide .4s cubic-bezier(.16,1,.3,1)}
.ios-guide.show{display:block}
.ios-guide-inner{max-width:500px;margin:0 auto}
.ios-guide-title{font-size:.84rem;font-weight:500;color:var(--text);margin-bottom:8px;display:flex;align-items:center;justify-content:space-between}
.ios-guide-close{background:none;border:none;color:var(--text-muted);cursor:pointer;width:28px;height:28px;display:flex;align-items:center;justify-content:center;border-radius:50%;padding:0}
.ios-guide-close:hover{color:var(--text);background:var(--accent-glow)}
.ios-guide-close svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round}
.ios-guide-steps{font-size:.78rem;color:var(--text-secondary);line-height:1.6}
.ios-guide-steps .ios-icon{display:inline-block;width:18px;height:18px;vertical-align:middle;margin:0 2px}
