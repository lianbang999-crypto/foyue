.playlist-panel{display:flex;flex-direction:column;overflow:hidden;padding:12px 16px 12px;row-gap:8px}

/* Bottom sheet behaviour: peek -> half -> full. Uses safe-area inset for device bottom.
	Default: peek (approx 22vh). When `.show` it's half-height (50vh). Add `.full` for fullscreen. */
.playlist-panel{position:fixed;left:0;right:0;bottom:0;z-index:520;display:flex;flex-direction:column;background:var(--bg);box-shadow:0 -8px 40px rgba(0,0,0,0.12);border-top-left-radius:16px;border-top-right-radius:16px;transform:translateY(100%);transition:transform .32s cubic-bezier(.2,.9,.3,1),height .32s;}
.playlist-panel::before{content:'';height:6px;width:44px;background:var(--border);border-radius:6px;margin:8px auto 0;display:block;opacity:.8}
.playlist-panel{height:22vh;max-height:100vh;padding:8px 16px calc(env(safe-area-inset-bottom, 0px) + 12px);}
.playlist-panel.show{transform:translateY(0);height:50vh}
.playlist-panel.full{height:100vh;border-top-left-radius:0;border-top-right-radius:0}
.playlist-tabs{display:flex;gap:0;border-bottom:1px solid var(--border);flex-shrink:0}
.pl-tab{-webkit-appearance:none;appearance:none;background:none;border:none;padding:10px 16px 8px;font-size:.84rem;font-weight:500;color:var(--text-muted);cursor:pointer;position:relative;transition:color .15s}
.pl-tab.active{color:var(--accent)}
.pl-tab.active::after{content:'';position:absolute;bottom:-1px;left:16px;right:16px;height:2px;background:var(--accent);border-radius:1px}
.playlist-sub{display:flex;align-items:center;justify-content:space-between;padding:8px 0 4px;flex-shrink:0}
.playlist-count{font-family:var(--font-en);font-size:.74rem;color:var(--text-muted)}
.pl-sort-btn{-webkit-appearance:none;appearance:none;background:none;border:none;display:flex;align-items:center;gap:4px;font-size:.74rem;color:var(--text-muted);cursor:pointer;padding:4px 0}
.pl-sort-btn:hover{color:var(--text-secondary)}
.playlist-items{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}
.pl-item{display:flex;align-items:center;gap:10px;padding:10px 4px;cursor:pointer;border-radius:var(--radius-sm);transition:background .15s;min-height:48px}
.pl-item:hover{background:var(--accent-glow)}
.pl-item.current{background:var(--accent-glow)}
.pl-item-num{font-family:var(--font-en);font-size:.74rem;color:var(--text-muted);width:24px;text-align:center;flex-shrink:0}
.pl-item.current .pl-item-num{color:var(--accent)}
.pl-item-body{flex:1;min-width:0}
.pl-item-title{font-size:.82rem;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.pl-item.current .pl-item-title{color:var(--accent);font-weight:500}
.pl-item-meta{display:flex;align-items:center;gap:6px;margin-top:2px}
.pl-item-duration{font-family:var(--font-en);font-size:.7rem;color:var(--text-muted)}
.pl-item-progress{font-size:.68rem;color:var(--accent);font-weight:500}
/* History items in playlist */
.pl-hist-sub{font-size:.72rem;color:var(--text-muted);margin-top:1px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

/* === PLAYER BAR - hidden (replaced by center play button) === */
.player{display:none}

/* Control buttons - modern circle style */
.ctrl{-webkit-appearance:none;appearance:none;background:none;border:none;color:var(--text-secondary);cursor:pointer;width:44px;height:44px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .15s}
.ctrl:hover{color:var(--text);background:var(--accent-glow)}
.ctrl svg{width:20px;height:20px;stroke:currentColor;fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}
.ctrl.active{color:var(--accent)}

/* Play/pause - the hero button */
.ctrl-play{width:44px;height:44px;background:var(--accent);border-radius:50%;color:var(--text-inverse);box-shadow:0 2px 12px rgba(131,106,50,0.25)}
.ctrl-play:hover{background:var(--accent);opacity:.88;transform:scale(1.04);color:var(--text-inverse)}
.ctrl-play svg{width:20px;height:20px;fill:currentColor;stroke:none}

/* === EXPANDED PLAYER === */
.expanded{position:fixed;inset:0;z-index:300;background:var(--bg);transform:translateY(100%);transition:transform .4s cubic-bezier(.16,1,.3,1);display:flex;flex-direction:column;overflow:hidden}
.expanded.show{transform:translateY(0)}

/* Top bar — collapse + track title + share */
.exp-top{display:flex;align-items:center;padding:max(12px,env(safe-area-inset-top)) 16px 8px;flex-shrink:0;background:var(--bg);position:relative;z-index:2}
.exp-top .btn-icon{min-width:44px;height:44px;flex-shrink:0}
.exp-top-title{flex:1;text-align:center;font-size:.92rem;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 4px;line-height:1.4}
.exp-top-right{display:flex;align-items:center;gap:0;flex-shrink:0}

/* Scrollable middle area */
.exp-player-content{display:flex;flex-direction:column;flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;padding:0 20px;align-items:center;justify-content:center}
.exp-player-content.hide{display:none}

/* Large cover area */
.exp-cover{width:min(300px,72vw);aspect-ratio:1/1;margin:0 auto 20px;border-radius:16px;overflow:hidden;background:var(--accent-glow);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;position:relative}
.exp-cover::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 30%,rgba(212,175,55,0.12),transparent 70%);pointer-events:none}
.exp-cover::after{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 100%,rgba(131,106,50,0.08),transparent 50%);pointer-events:none}
.exp-cover-img{width:75%;height:auto;object-fit:contain;opacity:.8;filter:drop-shadow(0 4px 16px rgba(131,106,50,0.2));position:relative;z-index:1}

/* Series info below cover */
.exp-info{text-align:center;margin-bottom:16px;flex-shrink:0;padding:0 8px}
.exp-series-name{font-size:.95rem;font-weight:600;color:var(--text);margin-bottom:3px;line-height:1.5;position:relative}
.exp-series-speaker{font-size:.78rem;color:var(--text-secondary);position:relative}
.exp-series{font-size:.78rem;color:var(--text-secondary);margin-top:2px}
.exp-series-ep-count{font-family:var(--font-en);font-size:.72rem;color:var(--text-muted);margin-top:6px;position:relative;letter-spacing:.04em}

/* Bottom controls area — pinned to bottom */
.exp-bottom{flex-shrink:0;padding:0 20px max(16px,var(--safe-bottom));background:var(--bg)}

/* Action bar — icon+label buttons */
.exp-action-bar{display:flex;align-items:center;justify-content:space-around;padding:0 4px;margin-bottom:14px}
.exp-action{-webkit-appearance:none;appearance:none;background:none;border:none;display:flex;flex-direction:column;align-items:center;gap:3px;color:var(--text-secondary);cursor:pointer;padding:6px 10px;font-size:.66rem;transition:color .15s;min-width:48px}
.exp-action svg{width:22px;height:22px;stroke:currentColor;fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}
.exp-action:hover{color:var(--text)}
.exp-action.active{color:var(--accent)}
.exp-action.speed-btn{font-family:var(--font-en);font-weight:600}
.exp-action.speed-btn span{font-size:.72rem;font-weight:600;letter-spacing:-.01em}

/* Progress row — skip buttons flanking slider */
.exp-progress{display:flex;align-items:center;gap:6px;margin-bottom:12px;touch-action:none;-webkit-user-select:none;user-select:none}
.exp-progress .ctrl-skip{width:36px;height:36px;flex-shrink:0}
.exp-progress .ctrl-skip svg{width:18px;height:18px}
.exp-progress .ctrl-skip .skip-label{position:absolute;font-family:var(--font-en);font-size:.45rem;font-weight:700;color:currentColor;bottom:6px;left:50%;transform:translateX(-50%);pointer-events:none;line-height:1}
.exp-progress-mid{flex:1;min-width:0}
.exp-progress-bar{width:100%;height:36px;cursor:pointer;position:relative;display:flex;align-items:center}
.exp-progress-track{width:100%;height:4px;background:var(--border);border-radius:2px;position:relative}
.exp-progress-fill{height:100%;background:var(--accent);border-radius:2px;width:0%;transition:width .1s linear;position:relative;z-index:1}
.exp-progress-thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:16px;height:16px;background:var(--accent);border-radius:50%;box-shadow:0 0 8px rgba(131,106,50,0.25);left:0%;transition:left .1s linear;z-index:2}
.exp-time{display:flex;justify-content:space-between;font-family:var(--font-en);font-size:.74rem;color:var(--text-muted);margin-top:2px}

/* Main controls — prev / PLAY / next / timer */
.exp-ctrls{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:8px}
.exp-ctrls .ctrl{width:46px;height:46px}
.exp-ctrls .ctrl svg{width:22px;height:22px}
.exp-ctrls .ctrl-play{width:66px;height:66px;box-shadow:0 4px 20px rgba(131,106,50,0.3)}
.exp-ctrls .ctrl-play svg{width:28px;height:28px}
.exp-ctrls .ctrl-skip{position:relative}

/* Sleep timer badge */
.timer-badge{position:absolute;top:2px;right:2px;background:var(--accent);color:var(--text-inverse);font-family:var(--font-en);font-size:.5rem;font-weight:600;min-width:16px;height:16px;border-radius:8px;display:flex;align-items:center;justify-content:center;padding:0 3px;line-height:1}

/* === SPEED CONTROL === */
.speed-btn{font-family:var(--font-en);font-size:.74rem;font-weight:600;min-width:44px;letter-spacing:-.01em}
.speed-btn .ctrl-label{font-size:.7rem}

/* === BUFFERING === */
.player-track.buffering::after{content:'...';animation:bufDots 1s steps(3) infinite}
@keyframes bufDots{0%{content:'.'}33%{content:'..'}66%{content:'...'}}
.center-play-btn.buffering{animation:centerPulse 1.2s ease-in-out infinite}
@keyframes centerPulse{0%,100%{box-shadow:0 2px 16px rgba(131,106,50,.3)}50%{box-shadow:0 2px 24px rgba(131,106,50,.6)}}
.exp-progress-buffer{position:absolute;height:100%;background:var(--accent);opacity:.15;border-radius:2px;width:0%;transition:width .3s linear}
